# Summarize the data

## Summarize by group

The following code will summarize the dataset by calculating the mean, standard deviation and standard error of the mean (SEM) of the `beak_length` variable.

Notice the use of the equations you learned in Part 2.

The `group_by(outcome)` function tells R to give us separate summaries for each outcome (died vs. survived).

```{r}
# summarize ---------------------------------------------------------------

# summarize the dataset by outcome (survived vs. died)
beak_length_grouped_summary <- 
  finches %>% 
  group_by(outcome) %>% 
  summarize(mean = mean(beak_length),
            sd = sd(beak_length),
            n = n()) %>% 
  mutate(sem = sd / sqrt(n),
         upper = mean + 1.96 * sem,
         lower = mean - 1.96 * sem)

# print the results in the console
beak_length_grouped_summary
```

## Plot summarized data

To plot these means and confidence intervals, you can use a bar chart with the `geom_col()` and `geom_errorbar()` functions in ggplot:

```{r bar-chart, fig.width=3, fig.height=4, fig.align='center'}
# bar chart ---------------------------------------------------------------

# bar chart of mean beak lengths
ggplot(
  data = beak_length_grouped_summary,   # dont use the original finches dataset
  mapping = aes(x = outcome,            # survival on the x axis
                y = mean,               # mean beak length on the y axis
                fill = outcome)         # make died/survived different colors
) +
  geom_col() +                          # add columns
  geom_errorbar(                        # add error bars
    mapping = aes(ymin = lower,         #   lower 95% confidence limit
                  ymax = upper),        #   upper 95% confidence limit
    width = .3                          #   width of horizontal part of bars
  ) +
  guides(fill = FALSE) +                # don't show a legend for fill color
  labs(
    title = "Figure 2.",                # title
    x = "Outcome",                      # x-axis label
    y = "Beak Length (mm)"              # y-axis label
  ) +
  theme(plot.title = element_text(size = rel(.8)))  # make title smaller
```

A good figure legend for this figure would be:

<blockquote class="text-info">Figure 2. <strong>Mean beak length varied between medium ground finches (<i>Geospiza fortis</i>) that survived or died during the 1977 drought on Daphne Major, Galapagos archipelago.</strong> Each sample consisted of 50 individuals. Birds were banded and measured during 1975-1977 and resighted in 1978. Error bars represent 95% confidence intervals.</blockquote>

Export your figure:

```{r save-barchart, eval=FALSE}
# save the beak length bar chart
# note that the dimensions are different from the histograms above
ggsave("Beak Length Bar Chart.png", 
       width = 2.5, height = 3.5, units = "in")  # DO NOT CHANGE
```

## Compare means

You have visualized the different samples, and it looks like there is a difference in the means. 


The question to ask is: could you have observed a difference as great as this if there is no real difference in the populations. Could you happen to have individuals with shorter beaks in one group simply due to an act of random samping? To answer that question, you need a statistical hypothesis test.

### Conduct a *t*-test

A t-test will tell you if the difference in means is likely due to chance (i.e. sampling error) or not.

The *t*-test function in R is a bit picky... it requires you to give it two arguments: a vector of measurements for one group and another vector of measurements for the other group. To do this, you must perform three steps:

1. Create a vector of beak lengths for birds that died.
2. Create a vector of beak lengths for birds that survived.
3. Compare the two vectors using a t-test.

STEP 1: The following code will take a dataset, in this case `finches`, remove rows that do not meet a given criteria, and extract the column of interest as a vector, and store the result as a new object named `beak_length_died`.

```{r}
# t-test ------------------------------------------------------------------

# get a vector of beak lengths for birds that died
beak_length_died <-
  finches %>%                     # start with finches dataset
  filter(outcome == "died") %>%   # only include rows w/ outcome=died
  pull(beak_length)               # extract the beak_length column

# print the new object in the console... it is a vector
beak_length_died
```

STEP 2: Now copy that code and change "died" to "survived" in your object name, so `beak_length_survived`, and in the filter criteria, so `outcome == "survived"`.

```{r}
# get a vector of beak lengths for birds that survived
beak_length_survived <-
  finches %>% 
  filter(outcome == "survived") %>% 
  pull(beak_length)

# print the results in the console
beak_length_survived
```

STEP 3: Perform a t-test using the `t.test()` function:

```{r}
# perform a two-sample t-test assuming unequal variances
t.test(beak_length_died, beak_length_survived)
```

Interpret the Results

The two numbers to focus on here are the **p-value** and the **95% confidence interval**.

The *p*-value tells you what proportion of the time you would expect to find a difference in population like these two if they were in fact the same. Scientists generally use a cutoff (or *alpha level*) of 0.05 to determine if a difference is "statistically significant". In this case, a *p*-value of 0.0004539 is much lower than 0.05, so we can reject our null hypothesis and accept our alternative hypothesis that the true difference in means is not equal to 0.

As further evidence that the difference between the means is not equal to zero, you can see that the 95% confidence interval does not include zero.

To report the findings of a t-test, for example in the Results section of a report or scientific article, you would say:

<blockquote class="text-info">Birds that survived the 1977 drought generally had longer beaks than those that died (Fig. 1). Mean beak lengths were 11.1 mm in survivors and 10.5 mm in non-survivors (Fig. 2).  This difference was stastistically significant according to a Welch's two-sample t-test assuming unequal variances (*t*=3.6335, *df*=94.807, *p*=0.0004539).</blockquote>